#!/bin/bash
shopt -s nullglob

# convert each /data/test/*.asm to list of attributes, no labels

TEST_IN=$1/*.asm
TEST_OUT=$2

for F in $TEST_IN
do
    asm_file=$(basename $F)
    out_path=$TEST_OUT/$asm_file

    grep -ao '_stdcall.*\|extrn.*' $F | sed 's/[$@\?0,\x27"]//g' | awk -F'[ :(]' 'length($2) > 4 { print $2 }' | sort | uniq >>$out_path

done
exit 0

