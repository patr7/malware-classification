<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Malware classification</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/one-page-wonder.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="#intro">Introduction</a>
                    </li>
                    <li>
                        <a href="#related_work">Related work</a>
                    </li>
                    <li>
                        <a href="#approach">Approach</a>
                    </li>
                    <li>
                        <a href="#results">Results</a>
                    </li>
                    <li>
                        <a href="#conclusions">Conclusions</a>
                    </li>					
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Full Width Image Header -->
    <header>
        <div>
            <div class="container">
                <h2 class="featurette-heading">Classifying Malware into families Based on File Content</h2>
                <h3>CAP 5610 - Machine Learning</h3>
                <h3>Prof. Ruogu Fang</h3>
				<h3>Team members: Patrick Rand, Reynier Ortiz</h3>
            </div>
        </div>
    </header>

    <!-- Page Content -->
    <div class="container">

        <hr class="featurette-divider">

        <!-- First Featurette -->
        <div class="featurette" id="intro">
            <h2 class="featurette-heading">Introduction</h2>

            <p class="lead">The malware industry continues to evolve in complexity, causing increased personal and commercial damage. Malware programmers have learned to evade signature detection by polymorphically obfuscating their code. Our goal of both research and industry: given a malware file, can we classify it into a common malware family, such that each instance of that family was morphed from the same original malware program? The ability to categorize a malicious program into a known family provides great importance because it allows for a more focused recovery and repair process.
            </p>
            <p class="lead">Microsoft has provided a sample data set of 10,838 disassembled malware executables, of which each program is given in both its hexadecimal byte form, and its assembly form. Each of these training examples have been labeled as belonging of one of the aforementioned malware families. The results of our experiment showed similar, and at times, improved classification accuracy compared to previous research. Also, our modified system, designed to handle our 400 GB training performed well and showed its ability to scale with the large data set. Given more time, we would have liked to explore how are system handles classifying both programs that do not belong to one of the 9 origin families, as well as those that are not malware.</p>
        </div>

        <hr class="featurette-divider">

        <!-- Related work -->
        <div class="featurette" id="related_work">
            <h2 class="featurette-heading">Related work</h2>
            <p class="lead">In "Semantics-aware malware detection" [Christodorescu et. al. 2005] the goal is to detect if a program exhibits a specified malicious behavior by determining if a set of templates of sequence of instructions are present in the executable files. This approach requires to have knowledge on semantics of each of the malware families, which is very expensive because implies having researchers investigating the malware behaviors.</p>
            <p class="lead">In "Proposal of n-gram based algorithm for malware classification." [Pekta et. al. 2011] instead of byte sequences, the n-grams extracted are formed by machine codes. Centroids are formed using the most frequent N-grams. This could lead to choose N-grams irrelevants to the malware family.</p>
            <p class="lead">We explored several other approaches, for example: "Malware classification using n-grams sequential pattern features" [Sornil et. al. 2013] and "Learning to detect and classify malicious executables in the wild" [Kolter and Maloof, 2006] but we chose to follow a similar methodology than the later because of the duration of the project.</p>
        </div>

        <hr class="featurette-divider">

        <!-- Approach -->
        <div class="featurette" id="approach">
            <img class="featurette-image img-responsive pull-right" src="./images/system_architecture.png">

            <h2 class="featurette-heading">Approach</h2>

            <p class="lead">Our approach, as shown in Fig 1 consisted in two basic steps: preprocessing the data and using several classification methods. Because of the length of the course we were not able to apply sequence pattern extraction or Markov Models, instead, we extracted the N-grams from each binary file, we calculated the information gain of each N-gram and selected the top 500 N-grams. </p>
            <h3><span class="text-muted">Data Preprocessing</span></h3>
            <p class="lead">We first extracted the N-grams, with n=4, using the kfNgram tool. The information gain was calculated using the average mutual information [Yang and Pederson, 1997].</p>
            <img class="featurette-image img-responsive center-block" src="./images/info_gain.png">
            <p class="lead">where <i>Ci</i> is the ith class, <i>vj</i> is the value of the jth attribute, <i>P(vj, Ci)</i> is the proportion that the jth attribute has the value <i>vj</i> in the class <i>Ci</i>, <i>P(vj)</i> is the proportion that the jth n-gram takes the value <i>vj</i> in the training data, and <i>P(Ci)</i> is the proportion of the training data belonging to the class <i>Ci</i> [Kolter and Maloof 2006].</p>
            <p class="lead">Once the information gain <i>(IG)</i> was calculated we selected the top 500 N-grams with the highest <i>IG</i>. Then these 500 N-grams represented the boolean attributes where "true" means the N-gram is present in the malware file or "false" if absent. We scanned each file to determine which of the 500 N-grams selected were present and transformed the training set into .arff format in order to be read by Weka in the classification phase.</p>

            <h3><span class="text-muted">Classification</span></h3>

            <p class="lead">To assign the malware executables one of the nine families, we used Weka [Witten and Frank 2005] to run several classifiers. The algorithms used were: Decision Trees (J48), Naïve Bayes and Support Vector Machines (SVM), and also applied <i>"boosting"</i> and <i>"bagging"</i> to these classifiers.</p>
        </div>

        <hr class="featurette-divider">

        <!-- Results -->
        <div class="featurette" id="results">
            <img class="featurette-image img-responsive pull-left" src="./images/results_table.png">
            <h2 class="featurette-heading">Results</h2>
            <p class="lead">The results of our evaluation will show how the feature extraction methods outlined in the Kolter paper and the family classification methods in the Rieck paper are scaled, and how we replicated and improved upon their results. We had the most success with the accuracy of the SVMs for both the API strings and the n-gram feature sets.</p>
        </div>

        <hr class="featurette-divider">
		
        <!-- Conclusions -->
        <div class="featurette" id="conclusions">
            <img class="featurette-image img-circle img-responsive pull-right" src="http://placehold.it/500x500">
            <h2 class="featurette-heading">Conclusions
                <span class="text-muted">Will Seal the Deal.</span>
            </h2>
            <p class="lead">Donec ullamcorper nulla non metus auctor fringilla. Vestibulum id ligula porta felis euismod semper. Praesent commodo cursus magna, vel scelerisque nisl consectetur. Fusce dapibus, tellus ac cursus commodo.</p>
        </div>

        <hr class="featurette-divider">

        <!-- References -->
        <div class="featurette" id="references">
            <h2 class="featurette-heading">References</h2>
            <p class="lead">Mihai Christodorescu, Somesh Jha, Sanjit A. Seshia, Dawn Song, and Randal E. Bryant. 2005. Semantics-Aware Malware Detection. (2005), 32–46.</p>
            <p class="lead">William H. Fletcher. 2012. Data mining: Practical machine learning tools and techniques. (2012). http://kwicfinder.com/kfNgram/kfNgramHelp.html</p>
            <p class="lead">J. Zico Kolter and Marcus A. Maloof. 2006. Learning to Detect and Classify Malicious Executables in the Wild. 7, Article 19 (2006), 2721–2744.</p>
            <p class="lead">Abdurrahman Pekta, Mehmet Eri, and Tankut Acarman. 2011. Proposal of n-gram Based Algorithm for Malware Classification. (2011).</p>
            <p class="lead">Ohm Sornil and Chatchai Liangboonprakong. 2013. Malware Classification Using N-grams Sequential Pattern Features. (2013).</p>
            <p class="lead">I. H. Witten and E. Frank. 2005. Data mining: Practical machine learning tools and techniques. (2005). http://www.cs.waikato.ac.nz/ml/weka/index.html</p>
            <p class="lead">Y. Yang and J. O. Pederson. 1997. A comparative study on feature selection in text categorization. (1997), 412–420.</p>
            <p class="lead">N. Zhong, Y. Li, and S. T. Wu. 2012. Effective Pattern Discovery for Text Mining. 24, Issue 1 (2012), 30–44.</p>
        </div>
		
        <!-- Footer -->
        <footer>
            <div class="row">
                <div class="col-lg-12">
                    <p>Florida International University</p>
                </div>
            </div>
        </footer>

    </div>
    <!-- /.container -->

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

</body>

</html>
